{% import "macros/taxonomies.html" as taxonomies -%}

{% extends "base.html" %} {% block content %}
<h1 class="title">{{ section.title }}</h1>

<article>{{ section.content | safe }}</article>

{% for year, posts in section.pages | group_by(attribute="year") -%}
<hr>
<h2>{{ year }}</h2>
<div class="g">
{% for post in posts -%}
{% if post.extra.images -%}
{% for image in post.extra.images -%}
<a href="{{ post.permalink | safe }}" title="{{ post.title }} - {{ post.date }}">{{ images::responsive_thumbnail(path=post.colocated_path, src=image, default_size=128, sizes=[128,256], alt=post.title ~ " - " ~ post.date ) }}</a>
{% endfor -%}
{% endif -%}
{% endfor -%}
</div>
{% endfor %}

<hr />

{% set taxonomies = get_taxonomy(kind="medium")  -%}
<ul class="list-inline small">
  <li class="label">Filter by medium:</li>
  {% for tax in taxonomies.items -%}
  {% set_global count = 0 -%}
  {% for page in tax.pages -%}
  {# <code>{{ page | json_encode(pretty=true) }}</code> #}
  {# {% if page.extra and page.extra.images %} #}
  {% set images = page.extra.images | length %}
  {% set_global count = count + images -%}
  {# {% endif -%} #}
  {% endfor -%}
  <li><a href='{{tax.permalink }}'>{{ tax.name }}</a> ({{count }})</li>
{% endfor -%}
</ul>


{% endblock content %}

