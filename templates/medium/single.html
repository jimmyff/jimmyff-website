{% extends "base.html" %}
{% import "macros/images.html" as images %}

{% block content %}

<h1><a href="{{ get_url(path='gallery')|safe}}">Gallery</a> &raquo; {{ term.name | capitalize }}</h1>

{% set sorted_pages = term.pages | sort(attribute="date") | reverse %}
<p>There are {{ sorted_pages | length }} entries, the first on {{ sorted_pages | last | get(key="date") | date(format="%d %B %Y") }} and the most recent on {{ sorted_pages | first | get(key="date") | date(format="%d %B %Y") }}.</p>

{% for year, posts in sorted_pages | group_by(attribute="year") %}
<hr>
<h2>{{ year }}</h2>
<div class="g">
{% for post in posts -%}
{% if post.extra.images -%}
{% for image in post.extra.images -%}
<a href="{{ post.permalink | safe }}" title="{{ post.title }} - {{ post.date }}">{{ images::responsive_thumbnail(path=post.colocated_path, src=image, default_size=128, sizes=[128,256], alt=post.title ~ " - " ~ post.date ) }}</a>
{% endfor -%}
{% endif -%}
{% endfor -%}
</div>
{% endfor %}

{% endblock content %}